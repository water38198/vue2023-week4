import{_ as S,r as $,w as A,o as p,c as v,a as e,t as y,b as h,v as f,F as C,d as V,e as R,f as I,p as N,g as E,n as U,h as P,u as L,i as O,j,k as F,l as H,m as k,S as x}from"./index-4Gdr3Z25.js";const b=d=>(N("data-v-aab3812e"),d=d(),E(),d),J={method:"dialog"},G={class:"bg-#212529 p-4 flex justify-between items-center"},W={class:"text-white"},q={class:"grid grid-cols-12 gap-6 p-3"},K={class:"col-span-4"},Q={class:"input-group"},X=b(()=>e("label",{for:"imagUrl",class:"block"},"主要圖片",-1)),Y=["src"],Z=b(()=>e("img",{src:"",alt:""},null,-1)),ee=b(()=>e("h4",null,"多圖新增",-1)),te={class:"flex justify-between mb-2"},oe={for:"images-1"},ae=["onClick"],se={class:"input-group"},ie=["onUpdate:modelValue"],le=["src"],ne={class:"col-span-8"},re={class:"grid grid-cols-2 gap-col-6 gap-row-4"},de={class:"input-group col-span-2"},ce=b(()=>e("label",{for:"title"},"標題",-1)),ue={class:"input-group"},pe=b(()=>e("label",{for:"category"},"分類",-1)),ve=I('<datalist id="categories" data-v-aab3812e><option value="策略" data-v-aab3812e>策略</option><option value="派對" data-v-aab3812e>派對</option><option value="雙人" data-v-aab3812e>雙人</option><option value="陣營" data-v-aab3812e>陣營</option><option value="家庭" data-v-aab3812e>家庭</option><option value="合作" data-v-aab3812e>合作</option><option value="劇情" data-v-aab3812e>劇情</option></datalist>',1),be={class:"input-group"},_e=b(()=>e("label",{for:"unit"},"單位",-1)),ge={class:"input-group"},he=b(()=>e("label",{for:"origin_price"},"原價",-1)),me={class:"input-group"},fe=b(()=>e("label",{for:"price"},"售價",-1)),xe=I('<div class="input-group" data-v-aab3812e><label for="language" data-v-aab3812e>語言</label><select name="" id="language" data-v-aab3812e><option value="繁體中文" data-v-aab3812e>繁體中文</option><option value="簡體中文" data-v-aab3812e>簡體中文</option><option value="英文" data-v-aab3812e>英文</option><option value="其他" data-v-aab3812e>其他</option></select></div><div class="input-group" data-v-aab3812e><label for="condition" data-v-aab3812e>狀況：</label><select name="" id="condition" data-v-aab3812e><option value="良好" data-v-aab3812e>良好</option><option value="盒子損傷" data-v-aab3812e>盒子損傷</option><option value="配件損傷" data-v-aab3812e>配件損傷</option><option value="受潮" data-v-aab3812e>受潮</option><option value="缺件" data-v-aab3812e>缺件</option><option value="其他" data-v-aab3812e>其他</option></select></div>',2),$e={class:"input-group col-span-2"},ye=b(()=>e("label",{for:"description"},"產品敘述",-1)),ke={class:"input-group col-span-2"},we=b(()=>e("label",{for:"content"},"說明內容",-1)),Ce=b(()=>e("label",{for:"is_enabled"},"是否啟用",-1)),Ue={class:"text-end p-3 border-t border-solid border-#dee2e6"},Pe={__name:"ProductModal",props:["tempProduct","isNew"],setup(d,{expose:m}){const i=d,t=$(i.tempProduct),c=$();function _(n){n.target.nodeName==="DIALOG"&&c.value.close()}function u(){t.value.imagesUrl||(t.value.imagesUrl=[]),t.value.imagesUrl[t.value.imagesUrl.length-1]!==""&&t.value.imagesUrl.push("")}return A(()=>i.tempProduct,()=>{t.value=i.tempProduct}),m({dialog:c}),(n,o)=>(p(),v("dialog",{ref_key:"dialog",ref:c,class:"max-w-1140px w-100% border-0 rd p-0 backdrop:backdrop-blur-3",onClick:_},[e("form",J,[e("div",G,[e("h3",W,y(d.isNew?"新增產品":"編輯產品"),1),e("button",{type:"button",class:"i-ic:baseline-close p-2 text-white font-size-4 hover:cursor-pointer",onClick:o[0]||(o[0]=a=>c.value.close())})]),e("div",q,[e("div",K,[e("div",Q,[X,h(e("input",{type:"text",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[1]||(o[1]=a=>t.value.imageUrl=a),class:"mb-2"},null,512),[[f,t.value.imageUrl]]),e("img",{src:t.value.imageUrl,alt:""},null,8,Y)]),Z,e("div",null,[ee,(p(!0),v(C,null,V(t.value.imagesUrl,(a,g)=>(p(),v("div",{key:a},[e("div",te,[e("label",oe,"圖片網址"+y(g+1),1),e("button",{class:"i-ic:baseline-close font-size-5 opacity-50 hover:cursor-pointer hover:opacity-75",onClick:w=>t.value.imagesUrl.splice(g,1)},null,8,ae)]),e("div",se,[h(e("input",{type:"text","onUpdate:modelValue":w=>t.value.imagesUrl[g]=w,placeholder:"請輸入圖片網址",class:",b-2"},null,8,ie),[[f,t.value.imagesUrl[g]]])]),e("img",{src:a,alt:""},null,8,le)]))),128)),e("button",{type:"button",class:"inline-block w-100% bg-transparent border-#0d6efd border-solid border-1 rd text-#0d6efd py-1 mb-1",hover:"cursor-pointer bg-#0d6efd text-white",onClick:u},"新增圖片")])]),e("div",ne,[e("div",re,[e("div",de,[ce,h(e("input",{type:"text",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":o[2]||(o[2]=a=>t.value.title=a)},null,512),[[f,t.value.title]])]),e("div",ue,[pe,h(e("input",{type:"text",id:"category",placeholder:"請輸入分類",list:"categories",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=a=>t.value.category=a)},null,512),[[f,t.value.category]]),ve]),e("div",be,[_e,h(e("input",{type:"text",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":o[4]||(o[4]=a=>t.value.unit=a)},null,512),[[f,t.value.unit]])]),e("div",ge,[he,h(e("input",{type:"number",id:"origin_price",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":o[5]||(o[5]=a=>t.value.origin_price=a)},null,512),[[f,t.value.origin_price,void 0,{number:!0}]])]),e("div",me,[fe,h(e("input",{type:"number",id:"price",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":o[6]||(o[6]=a=>t.value.price=a)},null,512),[[f,t.value.price,void 0,{number:!0}]])]),xe,e("div",$e,[ye,h(e("textarea",{name:"",id:"description",rows:"4","onUpdate:modelValue":o[7]||(o[7]=a=>t.value.description=a)},null,512),[[f,t.value.description]])]),e("div",ke,[we,h(e("textarea",{name:"",id:"content",rows:"4","onUpdate:modelValue":o[8]||(o[8]=a=>t.value.content=a)},null,512),[[f,t.value.content]])]),e("div",null,[h(e("input",{type:"checkbox",id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=a=>t.value.is_enabled=a),"true-value":1,"false-value":0},null,512),[[R,t.value.is_enabled]]),Ce])])])]),e("div",Ue,[e("button",{type:"button",class:"m-1 px-3 py-1.5 bg-transparent text-#6c757d border-1 border-solid border-#6c757d rd hover:cursor-pointer hover:bg-#5c636a hover:text-white",onClick:o[10]||(o[10]=a=>c.value.close())},"取消"),e("button",{type:"button",class:"m-1 px-3 py-1.5 text-white bg-#0d6efd border-0 rd hover:cursor-pointer hover:bg-#0b5ed7",onClick:o[11]||(o[11]=a=>n.$emit("confirmProduct",t.value))},"確定")])])],512))}},Ve=S(Pe,[["__scopeId","data-v-aab3812e"]]),T=d=>(N("data-v-9ee297f3"),d=d(),E(),d),Se={class:"container mx-a py-6"},Ie={class:"flex justify-center"},Ne={class:"flex items-center text-#0d6efd"},Ee=T(()=>e("div",{class:"i-mdi:arrow-left"},null,-1)),Te=[Ee],Me=["onClick"],Be=T(()=>e("div",{class:"i-mdi:arrow-right"},null,-1)),De=[Be],ze={__name:"PaginationComponent",props:["pages"],emits:["changePage"],setup(d,{emit:m}){const i=d,t=m;function c(_){t("changePage",_)}return(_,u)=>(p(),v("div",Se,[e("nav",Ie,[e("ul",Ne,[e("li",{class:U(["border-solid border-#dee2e6 border-1 border-collapse rd-tl rd-bl",{disabled:i.pages.current_page===1}])},[e("a",{href:"#",class:"block p-2 text-#0d6efd hover:bg-#e9ecef hover:cursor-pointer",onClick:u[0]||(u[0]=P(n=>c(i.pages.current_page-1),["prevent"]))},Te)],2),(p(!0),v(C,null,V(i.pages.total_pages,n=>(p(),v("li",{key:n,class:U(["border-solid border-#dee2e6 border-1 border-collapse",{active:n===i.pages.current_page}])},[e("a",{href:"#",class:"font-size-4 decoration-none block text-#0d6efd px-3 py-1 hover:bg-#e9ecef hover:cursor-pointer",onClick:P(o=>c(n),["prevent"])},y(n),9,Me)],2))),128)),e("li",{class:U(["border-solid border-#dee2e6 border-1 border-collapse rd-tr rd-br",{disabled:i.pages.current_page===i.pages.total_pages}])},[e("a",{href:"#",class:"block p-2 text-#0d6efd hover:bg-#e9ecef hover:cursor-pointer",onClick:u[1]||(u[1]=P(n=>c(i.pages.current_page+1),["prevent"]))},De)],2)])])]))}},Ae=S(ze,[["__scopeId","data-v-9ee297f3"]]);var Re={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/vue2023-week4/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Le={class:"container mx-a"},Oe={class:"text-end mt-6"},je={class:"w-100% mt-6"},Fe=e("thead",{class:"border-b-1 border-black border-solid fw-bold text-left"},[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120",class:"text-end"}," 原價 "),e("th",{width:"120",class:"text-end"}," 售價 "),e("th",{width:"100",class:"text-center"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),He={class:"text-end"},Je={class:"text-end"},Ge={class:"text-center"},We={key:0,class:"text-#198754"},qe={key:1,class:"text-red"},Ke={class:"btn-group"},Qe=["onClick"],Xe=["onClick"],Ze={__name:"ProductView",setup(d){const{VITE_URL:m,VITE_PATH:i}=Re,t=L(),c=$([]),_=$(),u=$({}),n=$(!0),o=$({});function a(){var l;const r=(l=document.cookie.split("; ").find(s=>s.startsWith("myToken=")))==null?void 0:l.split("=")[1];r&&(k.defaults.headers.common.Authorization=r),k.post(`${m}/v2/api/user/check`).then(()=>{g()}).catch(()=>{x.fire({title:"請先登入",icon:"error",didClose:()=>{t.push("/")}})})}function g(r=1){k.get(`${m}/v2/api/${i}/admin/products?page=${r}`).then(l=>{c.value=l.data.products,o.value=l.data.pagination})}function w(){_.value.dialog.showModal(),u.value={},n.value=!0}function M(r){u.value=JSON.parse(JSON.stringify(r)),n.value=!1,_.value.dialog.showModal()}function B(r){if(n.value)k.post(`${m}/v2/api/${i}/admin/product`,{data:r}).then(l=>{x.fire({title:`${l.data.message}`,icon:"success"}),_.value.dialog.close(),u.value={},g(o.value.current_page||1)}).catch(l=>{x.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${l}`})});else{const{id:l}=r;k.put(`${m}/v2/api/${i}/admin/product/${l}`,{data:r}).then(s=>{x.fire({title:`${s.data.message}`,icon:"success"}),_.value.dialog.close(),u.value={},g(o.value.current_page||1)}).catch(s=>{x.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${s.response.data.message}`})})}}function D(r){x.fire({title:`你確定要刪除 ${r.title} 嗎?`,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(l=>{l.isConfirmed&&k.delete(`${m}/v2/api/${i}/admin/product/${r.id}`).then(s=>{g(),x.fire(s.data.message),x.fire({icon:"success",text:s.data.message})}).catch(s=>{x.fire({icon:"error",text:s.response.data.message})})})}return O(()=>{a()}),(r,l)=>(p(),v(C,null,[e("div",Le,[e("div",Oe,[e("button",{type:"button",class:"bg-#0d6efd border-0 text-white cursor-pointer inline-block px-3 py-1.5 rd font-size-4 hover:bg-#0b5ed7",onClick:l[0]||(l[0]=s=>w())},"建立新的產品")]),e("table",je,[Fe,e("tbody",null,[(p(!0),v(C,null,V(c.value,s=>(p(),v("tr",{class:"border-b border-#DEE2E6 border-solid",key:s.id},[e("td",null,y(s.category),1),e("td",null,y(s.title),1),e("td",He,y(s.origin_price),1),e("td",Je,y(s.price),1),e("td",Ge,[s.is_enabled?(p(),v("span",We,"啟用")):(p(),v("span",qe,"未啟用"))]),e("td",null,[e("div",Ke,[e("button",{type:"button",class:"text-#0d6efd bg-transparent border-1 border-#0d6efd border-solid border-r-0 rd-tl rd-bl px-2 py-1 hover:bg-#0d6efd hover:text-white hover:cursor-pointer",onClick:z=>M(s)}," 編輯 ",8,Qe),e("button",{type:"button",class:"text-#dc3545 bg-transparent border-1 border-#de3545 border-solid rd-tr rd-br px-2 py-1 hover:bg-#de3545 hover:text-white hover:cursor-pointer",onClick:z=>D(s)}," 刪除 ",8,Xe)])])]))),128))])])]),j(Ve,{onConfirmProduct:B,"temp-product":u.value,"is-new":n.value,ref_key:"dialog",ref:_},null,8,["temp-product","is-new"]),c.value.length?(p(),F(Ae,{key:0,pages:o.value,onChangePage:g},null,8,["pages"])):H("",!0)],64))}};export{Ze as default};
