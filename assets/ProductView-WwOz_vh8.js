import{_ as P,r as x,w as R,o as r,c as p,a as e,t as h,b as f,v as _,F as k,d as U,e as L,f as V,p as S,g as I,n as w,h as C,u as O,i as j,j as F,k as H,l as J,m,S as g}from"./index-j_bAEwdq.js";const v=d=>(S("data-v-f1f8d340"),d=d(),I(),d),G={method:"dialog"},W={class:"bg-#212529 p-4 flex justify-between items-center"},q={class:"text-white"},K={class:"grid grid-cols-12 gap-6 p-3"},Q={class:"col-span-4"},X={class:"input-group"},Y=v(()=>e("label",{for:"imagUrl",class:"block"},"主要圖片",-1)),Z=["src"],ee=v(()=>e("img",{src:"",alt:""},null,-1)),te=v(()=>e("h4",null,"多圖新增",-1)),oe={class:"flex justify-between mb-2"},se={for:"images-1"},ae=["onClick"],ne={class:"input-group"},ie=["onUpdate:modelValue"],le=["src"],de={class:"col-span-8"},re={class:"grid grid-cols-2 gap-col-6 gap-row-4"},ce={class:"input-group col-span-2"},ue=v(()=>e("label",{for:"title"},"標題",-1)),pe={class:"input-group"},ve=v(()=>e("label",{for:"category"},"分類",-1)),fe=V('<datalist id="categories" data-v-f1f8d340><option value="策略" data-v-f1f8d340>策略</option><option value="派對" data-v-f1f8d340>派對</option><option value="雙人" data-v-f1f8d340>雙人</option><option value="陣營" data-v-f1f8d340>陣營</option><option value="家庭" data-v-f1f8d340>家庭</option></datalist>',1),_e={class:"input-group"},ge=v(()=>e("label",{for:"unit"},"單位",-1)),be={class:"input-group"},he=v(()=>e("label",{for:"origin_price"},"原價",-1)),me={class:"input-group"},xe=v(()=>e("label",{for:"price"},"售價",-1)),$e=V('<div class="input-group" data-v-f1f8d340><label for="language" data-v-f1f8d340>語言</label><select name="" id="language" data-v-f1f8d340><option value="繁體中文" data-v-f1f8d340>繁體中文</option><option value="簡體中文" data-v-f1f8d340>簡體中文</option><option value="英文" data-v-f1f8d340>英文</option><option value="其他" data-v-f1f8d340>其他</option></select></div><div class="input-group" data-v-f1f8d340><label for="condition" data-v-f1f8d340>狀況：</label><select name="" id="condition" data-v-f1f8d340><option value="良好" data-v-f1f8d340>良好</option><option value="盒子損傷" data-v-f1f8d340>盒子損傷</option><option value="配件損傷" data-v-f1f8d340>配件損傷</option><option value="受潮" data-v-f1f8d340>受潮</option><option value="缺件" data-v-f1f8d340>缺件</option><option value="其他" data-v-f1f8d340>其他</option></select></div>',2),ye={class:"input-group col-span-2"},ke=v(()=>e("label",{for:"description"},"產品敘述",-1)),we={class:"input-group col-span-2"},Ce=v(()=>e("label",{for:"content"},"說明內容",-1)),Ue=v(()=>e("label",{for:"is_enabled"},"是否啟用",-1)),Pe={class:"text-end p-3 border-t border-solid border-#dee2e6"},Ve={__name:"ProductModal",props:["tempProduct","isNew"],setup(d){const c=d,t=x(c.tempProduct);function $(){t.value.imagesUrl||(t.value.imagesUrl=[]),t.value.imagesUrl[t.value.imagesUrl.length-1]!==""&&t.value.imagesUrl.push("")}return R(()=>c.tempProduct,()=>{t.value=c.tempProduct}),(u,o)=>(r(),p("form",G,[e("div",W,[e("h3",q,h(d.isNew?"新增產品":"編輯產品"),1),e("button",{type:"button",class:"i-ic:baseline-close p-2 text-white font-size-4 hover:cursor-pointer",onClick:o[0]||(o[0]=s=>u.$emit("dialogClose"))})]),e("div",K,[e("div",Q,[e("div",X,[Y,f(e("input",{type:"text",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[1]||(o[1]=s=>t.value.imageUrl=s),class:"mb-2"},null,512),[[_,t.value.imageUrl]]),e("img",{src:t.value.imageUrl,alt:""},null,8,Z)]),ee,e("div",null,[te,(r(!0),p(k,null,U(t.value.imagesUrl,(s,l)=>(r(),p("div",{key:s},[e("div",oe,[e("label",se,"圖片網址"+h(l+1),1),e("button",{class:"i-ic:baseline-close font-size-5 opacity-50 hover:cursor-pointer hover:opacity-75",onClick:b=>t.value.imagesUrl.splice(l,1)},null,8,ae)]),e("div",ne,[f(e("input",{type:"text","onUpdate:modelValue":b=>t.value.imagesUrl[l]=b,placeholder:"請輸入圖片網址",class:",b-2"},null,8,ie),[[_,t.value.imagesUrl[l]]])]),e("img",{src:s,alt:""},null,8,le)]))),128)),e("button",{type:"button",class:"inline-block w-100% bg-transparent border-#0d6efd border-solid border-1 rd text-#0d6efd py-1 mb-1",hover:"cursor-pointer bg-#0d6efd text-white",onClick:$},"新增圖片")])]),e("div",de,[e("div",re,[e("div",ce,[ue,f(e("input",{type:"text",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":o[2]||(o[2]=s=>t.value.title=s)},null,512),[[_,t.value.title]])]),e("div",pe,[ve,f(e("input",{type:"text",id:"category",placeholder:"請輸入分類",list:"categories",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=s=>t.value.category=s)},null,512),[[_,t.value.category]]),fe]),e("div",_e,[ge,f(e("input",{type:"text",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":o[4]||(o[4]=s=>t.value.unit=s)},null,512),[[_,t.value.unit]])]),e("div",be,[he,f(e("input",{type:"number",id:"origin_price",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":o[5]||(o[5]=s=>t.value.origin_price=s)},null,512),[[_,t.value.origin_price,void 0,{number:!0}]])]),e("div",me,[xe,f(e("input",{type:"number",id:"price",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":o[6]||(o[6]=s=>t.value.price=s)},null,512),[[_,t.value.price,void 0,{number:!0}]])]),$e,e("div",ye,[ke,f(e("textarea",{name:"",id:"description",rows:"4","onUpdate:modelValue":o[7]||(o[7]=s=>t.value.description=s)},null,512),[[_,t.value.description]])]),e("div",we,[Ce,f(e("textarea",{name:"",id:"content",rows:"4","onUpdate:modelValue":o[8]||(o[8]=s=>t.value.content=s)},null,512),[[_,t.value.content]])]),e("div",null,[f(e("input",{type:"checkbox",id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=s=>t.value.is_enabled=s),"true-value":1,"false-value":0},null,512),[[L,t.value.is_enabled]]),Ue])])])]),e("div",Pe,[e("button",{type:"button",class:"m-1 px-3 py-1.5 bg-transparent text-#6c757d border-1 border-solid border-#6c757d rd hover:cursor-pointer hover:bg-#5c636a hover:text-white",onClick:o[10]||(o[10]=s=>u.$emit("dialogClose"))},"取消"),e("button",{type:"button",class:"m-1 px-3 py-1.5 text-white bg-#0d6efd border-0 rd hover:cursor-pointer hover:bg-#0b5ed7",onClick:o[11]||(o[11]=s=>u.$emit("confirmProduct",t.value))},"確定")])]))}},Se=P(Ve,[["__scopeId","data-v-f1f8d340"]]),N=d=>(S("data-v-9ee297f3"),d=d(),I(),d),Ie={class:"container mx-a py-6"},Ne={class:"flex justify-center"},Ee={class:"flex items-center text-#0d6efd"},Te=N(()=>e("div",{class:"i-mdi:arrow-left"},null,-1)),Me=[Te],Be=["onClick"],De=N(()=>e("div",{class:"i-mdi:arrow-right"},null,-1)),ze=[De],Ae={__name:"PaginationComponent",props:["pages"],emits:["changePage"],setup(d,{emit:c}){const t=d,$=c;function u(o){$("changePage",o)}return(o,s)=>(r(),p("div",Ie,[e("nav",Ne,[e("ul",Ee,[e("li",{class:w(["border-solid border-#dee2e6 border-1 border-collapse rd-tl rd-bl",{disabled:t.pages.current_page===1}])},[e("a",{href:"#",class:"block p-2 text-#0d6efd hover:bg-#e9ecef hover:cursor-pointer",onClick:s[0]||(s[0]=C(l=>u(t.pages.current_page-1),["prevent"]))},Me)],2),(r(!0),p(k,null,U(t.pages.total_pages,l=>(r(),p("li",{key:l,class:w(["border-solid border-#dee2e6 border-1 border-collapse",{active:l===t.pages.current_page}])},[e("a",{href:"#",class:"font-size-4 decoration-none block text-#0d6efd px-3 py-1 hover:bg-#e9ecef hover:cursor-pointer",onClick:C(b=>u(l),["prevent"])},h(l),9,Be)],2))),128)),e("li",{class:w(["border-solid border-#dee2e6 border-1 border-collapse rd-tr rd-br",{disabled:t.pages.current_page===t.pages.total_pages}])},[e("a",{href:"#",class:"block p-2 text-#0d6efd hover:bg-#e9ecef hover:cursor-pointer",onClick:s[1]||(s[1]=C(l=>u(t.pages.current_page+1),["prevent"]))},ze)],2)])])]))}},Re=P(Ae,[["__scopeId","data-v-9ee297f3"]]);var Le={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/vue2023-week4/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Oe={class:"container mx-a"},je={class:"text-end mt-6"},Fe={class:"w-100% mt-6"},He=e("thead",{class:"border-b-1 border-black border-solid fw-bold text-left"},[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120",class:"text-end"}," 原價 "),e("th",{width:"120",class:"text-end"}," 售價 "),e("th",{width:"100",class:"text-center"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),Je={class:"text-end"},Ge={class:"text-end"},We={class:"text-center"},qe={key:0,class:"text-#198754"},Ke={key:1,class:"text-red"},Qe={class:"btn-group"},Xe=["onClick"],Ye=["onClick"],et={__name:"ProductView",setup(d){const{VITE_URL:c,VITE_PATH:t}=Le,$=O(),u=x([]),o=x(),s=x({}),l=x(!0),b=x({});function E(){var n;const i=(n=document.cookie.split("; ").find(a=>a.startsWith("myToken=")))==null?void 0:n.split("=")[1];i&&(m.defaults.headers.common.Authorization=i),m.post(`${c}/v2/api/user/check`).then(()=>{y()}).catch(()=>{g.fire({title:"請先登入",icon:"error",didClose:()=>{$.push("/")}})})}function y(i=1){m.get(`${c}/v2/api/${t}/admin/products?page=${i}`).then(n=>{u.value=n.data.products,b.value=n.data.pagination})}function T(i){i.target.nodeName==="DIALOG"&&o.value.close()}function M(){o.value.showModal(),s.value={},l.value=!0}function B(i){s.value=JSON.parse(JSON.stringify(i)),l.value=!1,o.value.showModal()}function D(i){if(console.log(i),l.value)m.post(`${c}/v2/api/${t}/admin/product`,{data:i}).then(n=>{g.fire({title:`${n.data.message}`,icon:"success"}),o.value.close(),s.value={},y(b.value.current_page||1)}).catch(n=>{g.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${n.response.data.message}`})});else{const{id:n}=i;m.put(`${c}/v2/api/${t}/admin/product/${n}`,{data:i}).then(a=>{g.fire({title:`${a.data.message}`,icon:"success"}),o.value.close(),s.value={},y(b.value.current_page||1)}).catch(a=>{g.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${a.response.data.message}`})})}}function z(i){g.fire({title:`你確定要刪除 ${i.title} 嗎?`,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(n=>{n.isConfirmed&&m.delete(`${c}/v2/api/${t}/admin/product/${i.id}`).then(a=>{y(),g.fire(a.data.message),g.fire({icon:"success",text:a.data.message})}).catch(a=>{g.fire({icon:"error",text:a.response.data.message})})})}return j(()=>{E()}),(i,n)=>(r(),p(k,null,[e("div",Oe,[e("div",je,[e("button",{type:"button",class:"bg-#0d6efd border-0 text-white cursor-pointer inline-block px-3 py-1.5 rd font-size-4 hover:bg-#0b5ed7",onClick:n[0]||(n[0]=a=>M())},"建立新的產品")]),e("table",Fe,[He,e("tbody",null,[(r(!0),p(k,null,U(u.value,a=>(r(),p("tr",{class:"border-b border-#DEE2E6 border-solid",key:a.id},[e("td",null,h(a.category),1),e("td",null,h(a.title),1),e("td",Je,h(a.origin_price),1),e("td",Ge,h(a.price),1),e("td",We,[a.is_enabled?(r(),p("span",qe,"啟用")):(r(),p("span",Ke,"未啟用"))]),e("td",null,[e("div",Qe,[e("button",{type:"button",class:"text-#0d6efd bg-transparent border-1 border-#0d6efd border-solid border-r-0 rd-tl rd-bl px-2 py-1 hover:bg-#0d6efd hover:text-white hover:cursor-pointer",onClick:A=>B(a)}," 編輯 ",8,Xe),e("button",{type:"button",class:"text-#dc3545 bg-transparent border-1 border-#de3545 border-solid rd-tr rd-br px-2 py-1 hover:bg-#de3545 hover:text-white hover:cursor-pointer",onClick:A=>z(a)}," 刪除 ",8,Ye)])])]))),128))])])]),e("dialog",{ref_key:"dialog",ref:o,class:"max-w-1140px w-100% border-0 rd p-0 backdrop:backdrop-blur-3",onClick:T},[F(Se,{onDialogClose:n[1]||(n[1]=a=>o.value.close()),onConfirmProduct:D,"temp-product":s.value,"is-new":l.value},null,8,["temp-product","is-new"])],512),u.value.length?(r(),H(Re,{key:0,pages:b.value,onChangePage:y},null,8,["pages"])):J("",!0)],64))}};export{et as default};
